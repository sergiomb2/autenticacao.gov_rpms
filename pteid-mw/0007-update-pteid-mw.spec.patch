From 92496ff6c7d56c4fa6f89392066c260b2b3e54d3 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?S=C3=A9rgio=20M=2E=20Basto?= <sergio@serjux.com>
Date: Sun, 2 Jun 2019 07:34:26 +0100
Subject: [PATCH 7/8] update pteid-mw.spec

---
 pteid-mw.spec | 26 ++++++++++----------------
 1 file changed, 10 insertions(+), 16 deletions(-)

diff --git a/pteid-mw.spec b/pteid-mw.spec
index bca36b1..0b3fcef 100644
--- a/pteid-mw.spec
+++ b/pteid-mw.spec
@@ -79,22 +79,16 @@ License:        GPLv2+
 Group:          System/Libraries
 Version:        3.0.16.%{svn_revision}
 %if 0%{?fedora}
-Release:        1%{?dist}
+Release:        28.3%{?dist}
 %else
-Release:        1
+Release:        28.1
 %endif
 Summary:        Portuguese eID middleware
 Url:            https://svn.gov.pt/projects/ccidadao/
 Vendor:         Portuguese Government
 BuildRoot:      %{_tmppath}/%{name}-%{version}-build
-Source0:        pteid-mw_3.0.16svn%{svn_revision}-3.tar.xz
-Source1:        pteid-mw-gui.desktop
-Source2:        pteid-scalable.svg
-Source3:        pteid-signature.png
-
-Patch0:         support-openssl-1.1.patch
-Patch1:         fix-qt5.11-build-qicon.patch
-Patch2:         openssl1.1-support-eidguiV2.patch
+Source0:        pteid-mw_3.0.16svn%{svn_revision}-5.tar.gz
+
 %if 0%{?suse_version}
 BuildRequires:  update-desktop-files unzip
 %endif
@@ -112,11 +106,11 @@ Requires(postun): /usr/bin/gtk-update-icon-cache
  in certain websites and sign documents.
 %prep
 %setup -q -n pteid-mw_3.0.16svn%{svn_revision}
+# create dirs that git doesn't
+mkdir lib jar
+mkdir -p eidlibJava/class
 
 %if 0%{?fedora} || 0%{?suse_version}
-%patch0 -p0
-%patch1 -p0
-%patch2 -p0
 %endif
 
 
@@ -172,13 +166,13 @@ install -m 644 -p eidguiV2/eidmw_en.qm $RPM_BUILD_ROOT/usr/local/bin/
 install -m 644 -p eidguiV2/eidmw_nl.qm $RPM_BUILD_ROOT/usr/local/bin/
 
 mkdir -p $RPM_BUILD_ROOT/usr/share/applications
-install -m 644 %{SOURCE1} $RPM_BUILD_ROOT/usr/share/applications
+install -m 644 debian/pteid-mw-gui.desktop $RPM_BUILD_ROOT/usr/share/applications
 
 mkdir -p $RPM_BUILD_ROOT/usr/share/icons/hicolor/scalable/apps/
-install -m 644 -p %{SOURCE2} $RPM_BUILD_ROOT/usr/share/icons/hicolor/scalable/apps/
+install -m 644 -p debian/pteid-scalable.svg $RPM_BUILD_ROOT/usr/share/icons/hicolor/scalable/apps/
 
 mkdir -p $RPM_BUILD_ROOT/usr/share/pixmaps
-install -m 644 -p %{SOURCE3} $RPM_BUILD_ROOT/usr/share/pixmaps
+install -m 644 -p debian/pteid-signature.png $RPM_BUILD_ROOT/usr/share/pixmaps
 mkdir -p $RPM_BUILD_ROOT/usr/share/mime/packages
 
 %if 0%{?suse_version}
-- 
2.21.0

